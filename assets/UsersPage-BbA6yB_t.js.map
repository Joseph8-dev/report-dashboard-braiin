{"version":3,"file":"UsersPage-BbA6yB_t.js","sources":["../../src/pages/users/widgets/UsersTable.vue","../../src/pages/users/widgets/EditUserForm.vue","../../src/pages/users/UsersPage.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { defineVaDataTableColumns, useModal } from 'vuestic-ui'\nimport { User, UserRole } from '../types'\nimport UserAvatar from './UserAvatar.vue'\nimport { PropType, computed, toRef } from 'vue'\nimport { Pagination, Sorting } from '../../../data/pages/users'\nimport { useVModel } from '@vueuse/core'\nimport { Project } from '../../projects/types'\n\nconst columns = defineVaDataTableColumns([\n  { label: 'Full Name', key: 'fullname', sortable: true },\n  { label: 'Email', key: 'email', sortable: true },\n  { label: 'Username', key: 'username', sortable: true },\n  { label: 'Role', key: 'role', sortable: true },\n  { label: 'Projects', key: 'projects', sortable: true },\n  { label: ' ', key: 'actions', align: 'right' },\n])\n\nconst props = defineProps({\n  users: {\n    type: Array as PropType<User[]>,\n    required: true,\n  },\n  projects: {\n    type: Array as PropType<Project[]>,\n    required: true,\n  },\n  loading: { type: Boolean, default: false },\n  pagination: { type: Object as PropType<Pagination>, required: true },\n  sortBy: { type: String as PropType<Sorting['sortBy']>, required: true },\n  sortingOrder: { type: String as PropType<Sorting['sortingOrder']>, default: null },\n})\n\nconst emit = defineEmits<{\n  (event: 'edit-user', user: User): void\n  (event: 'delete-user', user: User): void\n  (event: 'update:sortBy', sortBy: Sorting['sortBy']): void\n  (event: 'update:sortingOrder', sortingOrder: Sorting['sortingOrder']): void\n}>()\n\nconst users = toRef(props, 'users')\nconst sortByVModel = useVModel(props, 'sortBy', emit)\nconst sortingOrderVModel = useVModel(props, 'sortingOrder', emit)\n\nconst roleColors: Record<UserRole, string> = {\n  admin: 'danger',\n  user: 'background-element',\n  owner: 'warning',\n}\n\nconst totalPages = computed(() => Math.ceil(props.pagination.total / props.pagination.perPage))\n\nconst { confirm } = useModal()\n\nconst onUserDelete = async (user: User) => {\n  const agreed = await confirm({\n    title: 'Delete user',\n    message: `Are you sure you want to delete ${user.fullname}?`,\n    okText: 'Delete',\n    cancelText: 'Cancel',\n    size: 'small',\n    maxWidth: '380px',\n  })\n\n  if (agreed) {\n    emit('delete-user', user)\n  }\n}\n\nconst formatProjectNames = (projects: Project['id'][]) => {\n  const names = projects.reduce((acc, p) => {\n    const project = props.projects?.find(({ id }) => p === id)\n\n    if (project) {\n      acc.push(project.project_name)\n    }\n\n    return acc\n  }, [] as string[])\n  if (names.length === 0) return 'No projects'\n  if (names.length <= 2) {\n    return names.map((name) => name).join(', ')\n  }\n\n  return (\n    names\n      .slice(0, 2)\n      .map((name) => name)\n      .join(', ') +\n    ' + ' +\n    (names.length - 2) +\n    ' more'\n  )\n}\n</script>\n\n<template>\n  <VaDataTable\n    v-model:sort-by=\"sortByVModel\"\n    v-model:sorting-order=\"sortingOrderVModel\"\n    :columns=\"columns\"\n    :items=\"users\"\n    :loading=\"$props.loading\"\n  >\n    <template #cell(fullname)=\"{ rowData }\">\n      <div class=\"flex items-center gap-2 max-w-[230px] ellipsis\">\n        <UserAvatar :user=\"rowData as User\" size=\"small\" />\n        {{ rowData.fullname }}\n      </div>\n    </template>\n\n    <template #cell(username)=\"{ rowData }\">\n      <div class=\"max-w-[120px] ellipsis\">\n        {{ rowData.username }}\n      </div>\n    </template>\n\n    <template #cell(email)=\"{ rowData }\">\n      <div class=\"ellipsis max-w-[230px]\">\n        {{ rowData.email }}\n      </div>\n    </template>\n\n    <template #cell(role)=\"{ rowData }\">\n      <VaBadge :text=\"rowData.role\" :color=\"roleColors[rowData.role as UserRole]\" />\n    </template>\n\n    <template #cell(projects)=\"{ rowData }\">\n      <div class=\"ellipsis max-w-[300px] lg:max-w-[450px]\">\n        {{ formatProjectNames(rowData.projects) }}\n      </div>\n    </template>\n\n    <template #cell(actions)=\"{ rowData }\">\n      <div class=\"flex gap-2 justify-end\">\n        <VaButton\n          preset=\"primary\"\n          size=\"small\"\n          icon=\"mso-edit\"\n          aria-label=\"Edit user\"\n          @click=\"$emit('edit-user', rowData as User)\"\n        />\n        <VaButton\n          preset=\"primary\"\n          size=\"small\"\n          icon=\"mso-delete\"\n          color=\"danger\"\n          aria-label=\"Delete user\"\n          @click=\"onUserDelete(rowData as User)\"\n        />\n      </div>\n    </template>\n  </VaDataTable>\n\n  <div class=\"flex flex-col-reverse md:flex-row gap-2 justify-between items-center py-2\">\n    <div>\n      <b>{{ $props.pagination.total }} results.</b>\n      Results per page\n      <VaSelect v-model=\"$props.pagination.perPage\" class=\"!w-20\" :options=\"[10, 50, 100]\" />\n    </div>\n\n    <div v-if=\"totalPages > 1\" class=\"flex\">\n      <VaButton\n        preset=\"secondary\"\n        icon=\"va-arrow-left\"\n        aria-label=\"Previous page\"\n        :disabled=\"$props.pagination.page === 1\"\n        @click=\"$props.pagination.page--\"\n      />\n      <VaButton\n        class=\"mr-2\"\n        preset=\"secondary\"\n        icon=\"va-arrow-right\"\n        aria-label=\"Next page\"\n        :disabled=\"$props.pagination.page === totalPages\"\n        @click=\"$props.pagination.page++\"\n      />\n      <VaPagination\n        v-model=\"$props.pagination.page\"\n        buttons-preset=\"secondary\"\n        :pages=\"totalPages\"\n        :visible-pages=\"5\"\n        :boundary-links=\"false\"\n        :direction-links=\"false\"\n      />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.va-data-table {\n  ::v-deep(.va-data-table__table-tr) {\n    border-bottom: 1px solid var(--va-background-border);\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { PropType, computed, ref, watch } from 'vue'\nimport { useForm } from 'vuestic-ui'\nimport { User, UserRole } from '../types'\nimport UserAvatar from './UserAvatar.vue'\nimport { useProjects } from '../../projects/composables/useProjects'\nimport { validators } from '../../../services/utils'\n\nconst props = defineProps({\n  user: {\n    type: Object as PropType<User | null>,\n    default: null,\n  },\n  saveButtonLabel: {\n    type: String,\n    default: 'Save',\n  },\n})\n\nconst defaultNewUser: Omit<User, 'id'> = {\n  avatar: '',\n  fullname: '',\n  role: 'user',\n  username: '',\n  notes: '',\n  email: '',\n  active: true,\n  projects: [],\n}\n\nconst newUser = ref<User>({ ...defaultNewUser } as User)\n\nconst isFormHasUnsavedChanges = computed(() => {\n  return Object.keys(newUser.value).some((key) => {\n    if (key === 'avatar' || key === 'projects') {\n      return false\n    }\n\n    return (\n      newUser.value[key as keyof Omit<User, 'id'>] !== (props.user ?? defaultNewUser)?.[key as keyof Omit<User, 'id'>]\n    )\n  })\n})\n\ndefineExpose({\n  isFormHasUnsavedChanges,\n})\n\nconst { projects } = useProjects({ pagination: ref({ page: 1, perPage: 9999, total: 10 }) })\n\nwatch(\n  [() => props.user, projects],\n  () => {\n    if (!props.user) {\n      return\n    }\n\n    newUser.value = {\n      ...props.user,\n      projects: props.user.projects.filter((projectId) => projects.value.find(({ id }) => id === projectId)),\n      avatar: props.user.avatar || '',\n    }\n  },\n  { immediate: true },\n)\n\nconst avatar = ref<File>()\n\nconst makeAvatarBlobUrl = (avatar: File) => {\n  return URL.createObjectURL(avatar)\n}\n\nwatch(avatar, (newAvatar) => {\n  newUser.value.avatar = newAvatar ? makeAvatarBlobUrl(newAvatar) : ''\n})\n\nconst form = useForm('add-user-form')\n\nconst emit = defineEmits(['close', 'save'])\n\nconst onSave = () => {\n  if (form.validate()) {\n    emit('save', newUser.value)\n  }\n}\n\nconst roleSelectOptions: { text: Capitalize<Lowercase<UserRole>>; value: UserRole }[] = [\n  { text: 'Admin', value: 'admin' },\n  { text: 'User', value: 'user' },\n  { text: 'Owner', value: 'owner' },\n]\n</script>\n\n<template>\n  <VaForm v-slot=\"{ isValid }\" ref=\"add-user-form\" class=\"flex-col justify-start items-start gap-4 inline-flex w-full\">\n    <VaFileUpload\n      v-model=\"avatar\"\n      type=\"single\"\n      hide-file-list\n      class=\"self-stretch justify-start items-center gap-4 inline-flex\"\n    >\n      <UserAvatar :user=\"newUser\" size=\"large\" />\n      <VaButton preset=\"primary\" size=\"small\">Add image</VaButton>\n      <VaButton\n        v-if=\"avatar\"\n        preset=\"primary\"\n        color=\"danger\"\n        size=\"small\"\n        icon=\"delete\"\n        class=\"z-10\"\n        @click.stop=\"avatar = undefined\"\n      />\n    </VaFileUpload>\n    <div class=\"self-stretch flex-col justify-start items-start gap-4 flex\">\n      <div class=\"flex gap-4 flex-col sm:flex-row w-full\">\n        <VaInput\n          v-model=\"newUser.fullname\"\n          label=\"Full name\"\n          class=\"w-full sm:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"fullName\"\n        />\n        <VaInput\n          v-model=\"newUser.username\"\n          label=\"Username\"\n          class=\"w-full sm:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"username\"\n        />\n      </div>\n      <div class=\"flex gap-4 flex-col sm:flex-row w-full\">\n        <VaInput\n          v-model=\"newUser.email\"\n          label=\"Email\"\n          class=\"w-full sm:w-1/2\"\n          :rules=\"[validators.required, validators.email]\"\n          name=\"email\"\n        />\n        <VaSelect\n          v-model=\"newUser.projects\"\n          label=\"Projects\"\n          class=\"w-full sm:w-1/2\"\n          :options=\"projects\"\n          value-by=\"id\"\n          text-by=\"project_name\"\n          :rules=\"[validators.required]\"\n          name=\"projects\"\n          multiple\n          :max-visible-options=\"2\"\n        />\n      </div>\n\n      <div class=\"flex gap-4 w-full\">\n        <div class=\"w-1/2\">\n          <VaSelect\n            v-model=\"newUser.role\"\n            label=\"Role\"\n            class=\"w-full\"\n            :options=\"roleSelectOptions\"\n            :rules=\"[validators.required]\"\n            name=\"role\"\n            value-by=\"value\"\n          />\n        </div>\n\n        <div class=\"flex items-center w-1/2 mt-4\">\n          <VaCheckbox v-model=\"newUser.active\" label=\"Active\" class=\"w-full\" name=\"active\" />\n        </div>\n      </div>\n\n      <VaTextarea v-model=\"newUser.notes\" label=\"Notes\" class=\"w-full\" name=\"notes\" />\n      <div class=\"flex gap-2 flex-col-reverse items-stretch justify-end w-full sm:flex-row sm:items-center\">\n        <VaButton preset=\"secondary\" color=\"secondary\" @click=\"$emit('close')\">Cancel</VaButton>\n        <VaButton :disabled=\"!isValid\" @click=\"onSave\">{{ saveButtonLabel }}</VaButton>\n      </div>\n    </div>\n  </VaForm>\n</template>\n","<script setup lang=\"ts\">\nimport { ref, watchEffect } from 'vue'\nimport UsersTable from './widgets/UsersTable.vue'\nimport EditUserForm from './widgets/EditUserForm.vue'\nimport { User } from './types'\nimport { useUsers } from './composables/useUsers'\nimport { useModal, useToast } from 'vuestic-ui'\nimport { useProjects } from '../projects/composables/useProjects'\n\nconst doShowEditUserModal = ref(false)\n\nconst { users, isLoading, filters, sorting, pagination, error, ...usersApi } = useUsers()\nconst { projects } = useProjects()\n\nconst userToEdit = ref<User | null>(null)\n\nconst showEditUserModal = (user: User) => {\n  userToEdit.value = user\n  doShowEditUserModal.value = true\n}\n\nconst showAddUserModal = () => {\n  userToEdit.value = null\n  doShowEditUserModal.value = true\n}\n\nconst { init: notify } = useToast()\n\nwatchEffect(() => {\n  if (error.value) {\n    notify({\n      message: error.value.message,\n      color: 'danger',\n    })\n  }\n})\n\nconst onUserSaved = async (user: User) => {\n  if (user.avatar.startsWith('blob:')) {\n    const blob = await fetch(user.avatar).then((r) => r.blob())\n    const { publicUrl } = await usersApi.uploadAvatar(blob)\n    user.avatar = publicUrl\n  }\n\n  if (userToEdit.value) {\n    await usersApi.update(user)\n    if (!error.value) {\n      notify({\n        message: `${user.fullname} has been updated`,\n        color: 'success',\n      })\n    }\n  } else {\n    await usersApi.add(user)\n\n    if (!error.value) {\n      notify({\n        message: `${user.fullname} has been created`,\n        color: 'success',\n      })\n    }\n  }\n}\n\nconst onUserDelete = async (user: User) => {\n  await usersApi.remove(user)\n  notify({\n    message: `${user.fullname} has been deleted`,\n    color: 'success',\n  })\n}\n\nconst editFormRef = ref()\n\nconst { confirm } = useModal()\n\nconst beforeEditFormModalClose = async (hide: () => unknown) => {\n  if (editFormRef.value.isFormHasUnsavedChanges) {\n    const agreed = await confirm({\n      maxWidth: '380px',\n      message: 'Form has unsaved changes. Are you sure you want to close it?',\n      size: 'small',\n    })\n    if (agreed) {\n      hide()\n    }\n  } else {\n    hide()\n  }\n}\n</script>\n\n<template>\n  <h1 class=\"page-title\">Users</h1>\n\n  <VaCard>\n    <VaCardContent>\n      <div class=\"flex flex-col md:flex-row gap-2 mb-2 justify-between\">\n        <div class=\"flex flex-col md:flex-row gap-2 justify-start\">\n          <VaButtonToggle\n            v-model=\"filters.isActive\"\n            color=\"background-element\"\n            border-color=\"background-element\"\n            :options=\"[\n              { label: 'Active', value: true },\n              { label: 'Inactive', value: false },\n            ]\"\n          />\n          <VaInput v-model=\"filters.search\" placeholder=\"Search\">\n            <template #prependInner>\n              <VaIcon name=\"search\" color=\"secondary\" size=\"small\" />\n            </template>\n          </VaInput>\n        </div>\n        <VaButton @click=\"showAddUserModal\">Add User</VaButton>\n      </div>\n\n      <UsersTable\n        v-model:sort-by=\"sorting.sortBy\"\n        v-model:sorting-order=\"sorting.sortingOrder\"\n        :users=\"users\"\n        :projects=\"projects\"\n        :loading=\"isLoading\"\n        :pagination=\"pagination\"\n        @editUser=\"showEditUserModal\"\n        @deleteUser=\"onUserDelete\"\n      />\n    </VaCardContent>\n  </VaCard>\n\n  <VaModal\n    v-slot=\"{ cancel, ok }\"\n    v-model=\"doShowEditUserModal\"\n    size=\"small\"\n    mobile-fullscreen\n    close-button\n    hide-default-actions\n    :before-cancel=\"beforeEditFormModalClose\"\n  >\n    <h1 class=\"va-h5\">{{ userToEdit ? 'Edit user' : 'Add user' }}</h1>\n    <EditUserForm\n      ref=\"editFormRef\"\n      :user=\"userToEdit\"\n      :save-button-label=\"userToEdit ? 'Save' : 'Add'\"\n      @close=\"cancel\"\n      @save=\"\n        (user) => {\n          onUserSaved(user)\n          ok()\n        }\n      \"\n    />\n  </VaModal>\n</template>\n"],"names":["columns","defineVaDataTableColumns","props","__props","emit","__emit","users","toRef","sortByVModel","useVModel","sortingOrderVModel","roleColors","totalPages","computed","confirm","useModal","onUserDelete","user","formatProjectNames","projects","names","acc","project","_a","id","name","_createVNode","_component_VaDataTable","_unref","$event","$props","_withCtx","rowData","_createElementVNode","_hoisted_1","UserAvatar","_toDisplayString","_hoisted_2","_hoisted_3","_component_VaBadge","_hoisted_4","_hoisted_5","_component_VaButton","$emit","_hoisted_6","_component_VaSelect","_openBlock","_createElementBlock","_hoisted_7","_cache","_component_VaPagination","defaultNewUser","newUser","ref","isFormHasUnsavedChanges","key","__expose","useProjects","watch","projectId","avatar","makeAvatarBlobUrl","newAvatar","form","useForm","onSave","roleSelectOptions","_createBlock","_component_VaForm","isValid","_component_VaFileUpload","_withModifiers","_component_VaInput","validators","_component_VaCheckbox","_component_VaTextarea","doShowEditUserModal","isLoading","filters","sorting","pagination","error","usersApi","useUsers","userToEdit","showEditUserModal","showAddUserModal","notify","useToast","watchEffect","onUserSaved","blob","r","publicUrl","editFormRef","beforeEditFormModalClose","hide","_component_VaCard","_component_VaCardContent","_component_VaButtonToggle","_component_VaIcon","UsersTable","_component_VaModal","cancel","ok","EditUserForm"],"mappings":"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"}