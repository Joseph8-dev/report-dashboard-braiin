import{u as y,a as _e,n as Q,r as U,U as Ve,w as M,g as le,W as Se,X as xe,c as J,Y as Pe,N as ie,d as W,m as E,Z as $e,j,$ as ue,e as O,a0 as Ce,i as S,F as ee,D as ce,V as de,f as w,y as pe,l as k,z as T,p as I,a1 as me,P as Ue,v as X,R as ke,H as Oe,a2 as G,x as z,q as fe,a3 as De,_ as ge,a4 as Ae,I as Te,T as Fe,M as Be,K as Ee,a5 as Ne}from"./index-CF5rea7A.js";import{u as Ie}from"./useModal-MeyIj38g.js";import{u as ze}from"./useToast-Cmzknb97.js";const Re=e=>e;function Le(e){return Se()?(xe(e),!0):!1}function te(e){return typeof e=="function"?e():y(e)}const Me=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const We=e=>typeof e<"u",Je=Object.prototype.toString,qe=e=>Je.call(e)==="[object Object]",He=()=>{};function Ge(e,t){function n(...a){return new Promise((r,o)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(r).catch(o)})}return n}const ve=e=>e();function Ke(e=ve){const t=U(!0);function n(){t.value=!1}function a(){t.value=!0}const r=(...o)=>{t.value&&e(...o)};return{isActive:Ve(t),pause:n,resume:a,eventFilter:r}}function Xe(e){return le()}function Ye(e,t,n={}){const{eventFilter:a=ve,...r}=n;return M(e,Ge(a,t),r)}function Ze(e,t,n={}){const{eventFilter:a,...r}=n,{eventFilter:o,pause:i,resume:p,isActive:f}=Ke(a);return{stop:Ye(e,t,{...r,eventFilter:o}),pause:i,resume:p,isActive:f}}function Qe(e,t=!0,n){Xe()?_e(e,n):t?e():Q(e)}function et(e){var t;const n=te(e);return(t=n==null?void 0:n.$el)!=null?t:n}const K=Me?window:void 0;function ae(...e){let t,n,a,r;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,a,r]=e,t=K):[t,n,a,r]=e,!t)return He;Array.isArray(n)||(n=[n]),Array.isArray(a)||(a=[a]);const o=[],i=()=>{o.forEach(l=>l()),o.length=0},p=(l,s,u,d)=>(l.addEventListener(s,u,d),()=>l.removeEventListener(s,u,d)),f=M(()=>[et(t),te(r)],([l,s])=>{if(i(),!l)return;const u=qe(s)?{...s}:s;o.push(...n.flatMap(d=>a.map(b=>p(l,d,b,u))))},{immediate:!0,flush:"post"}),g=()=>{f(),i()};return Le(g),g}function tt(e){return JSON.parse(JSON.stringify(e))}const q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},H="__vueuse_ssr_handlers__",nt=at();function at(){return H in q||(q[H]=q[H]||{}),q[H]}function ot(e,t){return nt[e]||t}function st(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const rt={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},oe="vueuse-storage";function lt(e,t,n,a={}){var r;const{flush:o="pre",deep:i=!0,listenToStorageChanges:p=!0,writeDefaults:f=!0,mergeDefaults:g=!1,shallow:l,window:s=K,eventFilter:u,onError:d=v=>{console.error(v)},initOnMounted:b}=a,_=(l?Pe:U)(t);if(!n)try{n=ot("getDefaultStorage",()=>{var v;return(v=K)==null?void 0:v.localStorage})()}catch(v){d(v)}if(!n)return _;const x=te(t),m=st(x),c=(r=a.serializer)!=null?r:rt[m],{pause:h,resume:D}=Ze(_,()=>V(_.value),{flush:o,deep:i,eventFilter:u});s&&p&&Qe(()=>{ae(s,"storage",L),ae(s,oe,Y),b&&L()}),b||L();function B(v,$){s&&s.dispatchEvent(new CustomEvent(oe,{detail:{key:e,oldValue:v,newValue:$,storageArea:n}}))}function V(v){try{const $=n.getItem(e);if(v==null)B($,null),n.removeItem(e);else{const F=c.write(v);$!==F&&(n.setItem(e,F),B($,F))}}catch($){d($)}}function P(v){const $=v?v.newValue:n.getItem(e);if($==null)return f&&x!=null&&n.setItem(e,c.write(x)),x;if(!v&&g){const F=c.read($);return typeof g=="function"?g(F,x):m==="object"&&!Array.isArray(F)?{...x,...F}:F}else return typeof $!="string"?$:c.read($)}function L(v){if(!(v&&v.storageArea!==n)){if(v&&v.key==null){_.value=x;return}if(!(v&&v.key!==e)){h();try{(v==null?void 0:v.newValue)!==c.write(_.value)&&(_.value=P(v))}catch($){d($)}finally{v?Q(D):D()}}}}function Y(v){L(v.detail)}return _}function it(e,t,n={}){const{window:a=K}=n;return lt(e,t,a==null?void 0:a.localStorage,n)}function se(e,t,n,a={}){var r,o,i;const{clone:p=!1,passive:f=!1,eventName:g,deep:l=!1,defaultValue:s,shouldEmit:u}=a,d=le(),b=n||(d==null?void 0:d.emit)||((r=d==null?void 0:d.$emit)==null?void 0:r.bind(d))||((i=(o=d==null?void 0:d.proxy)==null?void 0:o.$emit)==null?void 0:i.bind(d==null?void 0:d.proxy));let _=g;t||(t="modelValue"),_=_||`update:${t.toString()}`;const x=h=>p?typeof p=="function"?p(h):tt(h):h,m=()=>We(e[t])?x(e[t]):s,c=h=>{u?u(h)&&b(_,h):b(_,h)};if(f){const h=m(),D=U(h);let B=!1;return M(()=>e[t],V=>{B||(B=!0,D.value=x(V),Q(()=>B=!1))}),M(D,V=>{!B&&(V!==e[t]||l)&&c(V)},{deep:l}),D}else return J({get(){return m()},set(h){c(h)}})}const R=void 0,N={allUsers:()=>`${R}/users`,user:e=>`${R}/users/${e}`,users:({page:e,pageSize:t})=>`${R}/users/?page=${e}&pageSize=${t}`,allProjects:()=>`${R}/projects`,project:e=>`${R}/projects/${e}`,projects:({page:e,pageSize:t})=>`${R}/projects/?page=${e}&pageSize=${t}`,avatars:()=>`${R}/avatars`},ut=async e=>{const t=await fetch(N.allProjects()).then(n=>n.json());return{data:t,pagination:{page:e.page,perPage:e.perPage,total:t.length}}},ct=async e=>{const t=new Headers;return t.append("Content-Type","application/json"),fetch(N.allProjects(),{method:"POST",body:JSON.stringify(e),headers:t}).then(n=>n.json())},dt=async e=>{const t=new Headers;return t.append("Content-Type","application/json"),fetch(N.project(e.id),{method:"PUT",body:JSON.stringify(e),headers:t}).then(n=>n.json())},pt=async e=>fetch(N.project(e.id),{method:"DELETE"}),mt=ie("projects",{state:()=>({items:[],pagination:{page:1,perPage:10,total:0}}),actions:{async getAll(e){const{data:t,pagination:n}=await ut({...e.sorting,...e.pagination});this.items=t,this.pagination=n},async add(e){const[t]=await ct(e);this.items.push(t)},async update(e){const[t]=await dt(e),n=this.items.findIndex(({id:a})=>a===e.id);this.items.splice(n,1,t)},async remove(e){if(await pt(e)){const n=this.items.findIndex(({id:a})=>a===e.id);this.items.splice(n,1)}}}}),C=[];for(let e=0;e<256;++e)C.push((e+256).toString(16).slice(1));function ft(e,t=0){return(C[e[t+0]]+C[e[t+1]]+C[e[t+2]]+C[e[t+3]]+"-"+C[e[t+4]]+C[e[t+5]]+"-"+C[e[t+6]]+C[e[t+7]]+"-"+C[e[t+8]]+C[e[t+9]]+"-"+C[e[t+10]]+C[e[t+11]]+C[e[t+12]]+C[e[t+13]]+C[e[t+14]]+C[e[t+15]]).toLowerCase()}let Z;const gt=new Uint8Array(16);function vt(){if(!Z){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Z=crypto.getRandomValues.bind(crypto)}return Z(gt)}const yt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),re={randomUUID:yt};function wt(e,t,n){var r;if(re.randomUUID&&!e)return re.randomUUID();e=e||{};const a=e.random??((r=e.rng)==null?void 0:r.call(e))??vt();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,ft(a)}const bt=async e=>{const{isActive:t,search:n}=e;let a=await fetch(N.allUsers()).then(i=>i.json());a=a.filter(i=>i.active===t),n&&(a=a.filter(i=>i.fullname.toLowerCase().includes(n.toLowerCase())));const{page:r=1,perPage:o=10}=e||{};return{data:a,pagination:{page:r,perPage:o,total:a.length}}},ht=async e=>{const t=new Headers;t.append("Content-Type","application/json");const n=await fetch(N.allUsers(),{method:"POST",body:JSON.stringify(e),headers:t}).then(a=>a.json());if(!n.error)return n;throw new Error(n.error)},jt=async e=>{const t=new Headers;t.append("Content-Type","application/json");const n=await fetch(N.user(e.id),{method:"PUT",body:JSON.stringify(e),headers:t}).then(a=>a.json());if(!n.error)return n;throw new Error(n.error)},_t=async e=>fetch(N.user(e.id),{method:"DELETE"}),Vt=async e=>fetch(N.avatars(),{method:"POST",body:e,redirect:"follow"}).then(t=>t.json()),ye=ie("users",{state:()=>({items:[],pagination:{page:1,perPage:10,total:0}}),actions:{async getAll(e){const{data:t,pagination:n}=await bt({...e.filters,...e.sorting,...e.pagination});this.items=t,this.pagination=n},async add(e){const[t]=await ht(e);return this.items.unshift(t),t},async update(e){const[t]=await jt(e),n=this.items.findIndex(({id:a})=>a===e.id);return this.items.splice(n,1,t),t},async remove(e){if(await _t(e)){const n=this.items.findIndex(({id:a})=>a===e.id);this.items.splice(n,1)}},async uploadAvatar(e){return Vt(e)}}}),St=()=>U({page:1,perPage:10,total:0}),xt=()=>U({sortBy:"fullname",sortingOrder:null}),Pt=()=>U({isActive:!0,search:""}),$t=e=>{const t=U(!1),n=U(),a=ye(),{filters:r=Pt(),sorting:o=xt(),pagination:i=St()}={},p=async()=>{t.value=!0;try{await a.getAll({filters:y(r),sorting:y(o),pagination:y(i)}),i.value=a.pagination}finally{t.value=!1}};M(r,()=>{i.value.page=1,p()},{deep:!0}),p();const f=J(()=>{const g=(s,u)=>u==="projects"?s.projects.map(d=>d).join(", "):s[u],l=a.items.slice((i.value.page-1)*i.value.perPage,i.value.page*i.value.perPage);return o.value.sortBy&&o.value.sortingOrder&&l.sort((s,u)=>{const d=g(s,o.value.sortBy),b=g(u,o.value.sortBy);return d>b?o.value.sortingOrder==="asc"?1:-1:d<b?o.value.sortingOrder==="asc"?-1:1:0}),l});return{error:n,isLoading:t,filters:r,sorting:o,pagination:i,users:f,fetch:p,async add(g){t.value=!0;try{return await a.add(g)}catch(l){n.value=l}finally{t.value=!1}},async update(g){t.value=!0;try{return await a.update(g)}catch(l){n.value=l}finally{t.value=!1}},async remove(g){t.value=!0;try{return await a.remove(g)}catch(l){n.value=l}finally{t.value=!1}},async uploadAvatar(g){const l=new FormData;return l.append("avatar",g),l.append("id",wt()),a.uploadAvatar(l)}}};function we(){const{users:e}=$t(),t=r=>e.value.find(({id:o})=>r===o),n=r=>{const o=["primary","#FFD43A","#ADFF00","#262824","danger"],i=r.charCodeAt(0)%o.length;return o[i]};return{users:e,getUserById:t,getTeamOptions:r=>r.reduce((o,i)=>{const p=t(i);return p&&o.push({label:p.fullname,src:p.avatar,fallbackText:p.fullname[0],color:n(p.fullname)}),o},[])}}const Ct=()=>U({page:1,perPage:10,total:0}),Ut=()=>U({sortBy:"created_at",sortingOrder:"desc"}),kt=e=>{const t=U(!1),n=mt(),{getUserById:a}=we(),{sorting:r=Ut(),pagination:o=Ct()}={},i=async()=>{t.value=!0,await n.getAll({sorting:y(r),pagination:y(o)}),o.value=n.pagination,t.value=!1},p=J(()=>{const f=n.items.slice((o.value.page-1)*o.value.perPage,o.value.page*o.value.perPage),g=(l,s)=>{var u;return s==="project_owner"?(u=a(l.project_owner))==null?void 0:u.fullname:s==="team"?l.team.map(d=>{var b;return((b=a(d))==null?void 0:b.fullname)||""}).join(", "):s==="created_at"?new Date(l[s]):l[s]};return r.value.sortBy&&r.value.sortingOrder&&f.sort((l,s)=>(l=g(l,r.value.sortBy),s=g(s,r.value.sortBy),l<s?r.value.sortingOrder==="asc"?-1:1:l>s?r.value.sortingOrder==="asc"?1:-1:0)),f});return i(),{isLoading:t,projects:p,fetch:i,async add(f){t.value=!0,await n.add(f),await i(),t.value=!1},async update(f){t.value=!0,await n.update(f),await i(),t.value=!1},async remove(f){t.value=!0,await n.remove(f),await i(),t.value=!1},pagination:o,sorting:r}},ne=W({__name:"ProjectStatusBadge",props:{status:{type:String,required:!0}},setup(e){const t={"in progress":"primary",archived:"secondary",completed:"success",important:"warning"};return(n,a)=>{const r=$e;return j(),E(r,{square:"",color:t[n.$props.status],text:n.$props.status.toUpperCase()},null,8,["color","text"])}}}),Ot={class:"text-[var(--va-secondary)]"},Dt={class:"flex flex-col items-center gap-4 grow"},At={class:"va-h4 text-center self-stretch overflow-hidden line-clamp-2 text-ellipsis"},Tt={key:0},Ft={class:"flex justify-between"},Bt={key:1,class:"p-4 flex justify-center items-center text-[var(--va-secondary)]"},Et=W({__name:"ProjectCards",props:{projects:{type:Array,required:!0},loading:{type:Boolean,required:!0}},emits:["edit","delete"],setup(e){const{getUserById:t,getTeamOptions:n}=ue("ProjectsPage");return(a,r)=>{const o=me,i=Ue,p=X,f=pe,g=de,l=Ce;return e.projects.length>0||e.loading?(j(),E(l,{key:0,loading:e.loading,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 min-h-[4rem]"},{default:S(()=>[(j(!0),O(ee,null,ce(e.projects,s=>(j(),E(g,{key:s.project_name,style:{"--va-card-outlined-border":"1px solid var(--va-background-element)"},outlined:""},{default:S(()=>[w(f,{class:"flex flex-col h-full"},{default:S(()=>[k("div",Ot,T(new Date(s.created_at).toLocaleDateString()),1),k("div",Dt,[k("h4",At,T(s.project_name),1),k("p",null,[r[0]||(r[0]=k("span",{class:"text-[var(--va-secondary)]"},"Owner: ",-1)),y(t)(s.project_owner)?(j(),O("span",Tt,T(y(t)(s.project_owner).fullname),1)):I("",!0)]),w(o,{class:"my-4",options:y(n)(s.team),max:5},null,8,["options"]),w(ne,{status:s.status},null,8,["status"])]),w(i,{class:"my-6"}),k("div",Ft,[w(p,{preset:"secondary",icon:"mso-edit",color:"secondary",onClick:u=>a.$emit("edit",s)},null,8,["onClick"]),w(p,{preset:"secondary",icon:"mso-delete",color:"danger",onClick:u=>a.$emit("delete",s)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["loading"])):(j(),O("div",Bt,"No projects"))}}}),be=W({__name:"UserAvatar",props:{user:{type:Object,required:!0},size:{type:String,default:"medium"}},setup(e){const t=r=>{const o=["primary","#FFD43A","#ADFF00","#262824","danger"],i=r.charCodeAt(0)%o.length;return o[i]},n=r=>r?r.startsWith("http")||r.startsWith("blob:"):!1,a=r=>{try{const[o,i]=r.split(" ");return`${o[0]}${i[0]}`}catch{return r[0]}};return(r,o)=>{const i=ke;return j(),E(i,{size:e.size,src:n(e.user.avatar)?e.user.avatar:"","fallback-text":a(e.user.fullname),color:t(e.user.fullname)},null,8,["size","src","fallback-text","color"])}}}),Nt={class:"ellipsis max-w-[230px] lg:max-w-[450px]"},It={key:0,class:"flex items-center gap-2 ellipsis max-w-[230px]"},zt={class:"flex gap-2 justify-end"},Rt={class:"flex flex-col-reverse md:flex-row gap-2 justify-between items-center py-2"},Lt={key:0,class:"flex"},Mt=W({__name:"ProjectsTable",props:{projects:{type:Array,required:!0},loading:{type:Boolean,required:!0},sortBy:{type:String,default:void 0},sortingOrder:{type:String,default:void 0},pagination:{type:Object,required:!0}},emits:["edit","delete"],setup(e,{emit:t}){const n=Re([{label:"Project name",key:"project_name",sortable:!0},{label:"Project owner",key:"project_owner",sortable:!0},{label:"Team",key:"team",sortable:!0},{label:"Status",key:"status",sortable:!0},{label:"Creation Date",key:"created_at",sortable:!0},{label:" ",key:"actions"}]),a=e,r=t,o=se(a,"sortBy",r),i=se(a,"sortingOrder",r),p=J(()=>Math.ceil(a.pagination.total/a.pagination.perPage)),{getUserById:f,getTeamOptions:g}=ue("ProjectsPage");return(l,s)=>{const u=me,d=X,b=Oe,_=fe,x=De;return j(),O("div",null,[w(b,{"sort-by":y(o),"onUpdate:sortBy":s[0]||(s[0]=m=>G(o)?o.value=m:null),"sorting-order":y(i),"onUpdate:sortingOrder":s[1]||(s[1]=m=>G(i)?i.value=m:null),items:e.projects,columns:y(n),loading:e.loading},{"cell(project_name)":S(({rowData:m})=>[k("div",Nt,T(m.project_name),1)]),"cell(project_owner)":S(({rowData:m})=>[y(f)(m.project_owner)?(j(),O("div",It,[w(be,{user:y(f)(m.project_owner),size:"small"},null,8,["user"]),z(" "+T(y(f)(m.project_owner).fullname),1)])):I("",!0)]),"cell(team)":S(({rowData:m})=>[w(u,{size:"small",options:y(g)(m.team),max:5},null,8,["options"])]),"cell(status)":S(({rowData:m})=>[w(ne,{status:m.status},null,8,["status"])]),"cell(created_at)":S(({rowData:m})=>[z(T(new Date(m.created_at).toLocaleDateString()),1)]),"cell(actions)":S(({rowData:m})=>[k("div",zt,[w(d,{preset:"primary",size:"small",color:"primary",icon:"mso-edit","aria-label":"Edit project",onClick:c=>l.$emit("edit",m)},null,8,["onClick"]),w(d,{preset:"primary",size:"small",icon:"mso-delete",color:"danger","aria-label":"Delete project",onClick:c=>l.$emit("delete",m)},null,8,["onClick"])])]),_:1},8,["sort-by","sorting-order","items","columns","loading"]),k("div",Rt,[k("div",null,[k("b",null,T(l.$props.pagination.total)+" results.",1),s[6]||(s[6]=z(" Results per page ",-1)),w(_,{modelValue:l.$props.pagination.perPage,"onUpdate:modelValue":s[2]||(s[2]=m=>l.$props.pagination.perPage=m),class:"!w-20",options:[10,50,100]},null,8,["modelValue"])]),p.value>1?(j(),O("div",Lt,[w(d,{preset:"secondary",icon:"va-arrow-left","aria-label":"Previous page",disabled:l.$props.pagination.page===1,onClick:s[3]||(s[3]=m=>l.$props.pagination.page--)},null,8,["disabled"]),w(d,{class:"mr-2",preset:"secondary",icon:"va-arrow-right","aria-label":"Next page",disabled:l.$props.pagination.page===p.value,onClick:s[4]||(s[4]=m=>l.$props.pagination.page++)},null,8,["disabled"]),w(x,{modelValue:l.$props.pagination.page,"onUpdate:modelValue":s[5]||(s[5]=m=>l.$props.pagination.page=m),"buttons-preset":"secondary",pages:p.value,"visible-pages":5,"boundary-links":!1,"direction-links":!1},null,8,["modelValue","pages"])])):I("",!0)])])}}}),Wt=ge(Mt,[["__scopeId","data-v-b93c3aed"]]),Jt={class:"flex justify-end flex-col-reverse sm:flex-row mt-4 gap-2"},qt=W({__name:"EditProjectForm",props:{project:{},saveButtonLabel:{}},emits:["save","close"],setup(e,{expose:t}){const n=e,a=Ae(),r={project_name:"",project_owner:void 0,team:[],status:void 0},o=U({...r}),i=J(()=>Object.keys(o.value).some(s=>{var u;return s==="team"?!1:o.value[s]!==((u=n.project??r)==null?void 0:u[s])}));t({isFormHasUnsavedChanges:i});const p=ye();M(()=>n.project,()=>{n.project&&(o.value={...n.project,project_owner:n.project.project_owner})},{immediate:!0});const f=s=>!!s||"Este campo es obligatorio",g=U(""),l=U("");return(s,u)=>{const d=Te,b=fe,_=X,x=Fe;return j(),E(x,{class:"flex flex-col gap-2"},{default:S(({validate:m})=>[w(d,{modelValue:o.value.project_name,"onUpdate:modelValue":u[0]||(u[0]=c=>o.value.project_name=c),label:"Project name",rules:[f]},null,8,["modelValue","rules"]),w(b,{modelValue:o.value.project_owner,"onUpdate:modelValue":u[1]||(u[1]=c=>o.value.project_owner=c),search:g.value,"onUpdate:search":u[2]||(u[2]=c=>g.value=c),searchable:"",label:"Owner","text-by":"fullname","track-by":"id","value-by":"id",rules:[f],options:y(p).items},{content:S(({value:c})=>[c?(j(),O("div",{key:c.id,class:"flex items-center gap-1 mr-4"},[I("",!0),z(" "+T(c.fullname),1)])):I("",!0)]),_:1},8,["modelValue","search","rules","options"]),w(b,{modelValue:o.value.team,"onUpdate:modelValue":u[3]||(u[3]=c=>o.value.team=c),search:l.value,"onUpdate:search":u[4]||(u[4]=c=>l.value=c),label:"Team","text-by":"fullname","track-by":"id","value-by":"id",multiple:"",rules:[c=>"length"in c&&c.length>0||"Este campo es obligatorio"],options:y(p).items,"max-visible-options":y(a).mdUp?3:1},{content:S(({valueArray:c})=>[c!=null&&c.length?(j(!0),O(ee,{key:0},ce(c,(h,D)=>(j(),O("div",{key:h.id,class:"flex items-center gap-1 mr-2"},[h?(j(),E(be,{key:0,user:h,size:"18px"},null,8,["user"])):I("",!0),z(" "+T(h.fullname)+T(D<c.length-1?",":""),1)]))),128)):I("",!0)]),_:1},8,["modelValue","search","rules","options","max-visible-options"]),w(b,{modelValue:o.value.status,"onUpdate:modelValue":u[5]||(u[5]=c=>o.value.status=c),label:"Status",rules:[f],"track-by":"value","value-by":"value",options:[{text:"In progress",value:"in progress"},{text:"Archived",value:"archived"},{text:"Completed",value:"completed"},{text:"Important",value:"important"}]},{content:S(({value:c})=>[c?(j(),E(ne,{key:0,status:c.value},null,8,["status"])):I("",!0)]),_:1},8,["modelValue","rules"]),k("div",Jt,[w(_,{preset:"secondary",color:"secondary",onClick:u[6]||(u[6]=c=>s.$emit("close"))},{default:S(()=>[...u[7]||(u[7]=[z("Cancel",-1)])]),_:1}),w(_,{onClick:c=>m()&&s.$emit("save",o.value)},{default:S(()=>[z(T(e.saveButtonLabel),1)]),_:1},8,["onClick"])])]),_:1})}}}),Ht=ge(qt,[["__scopeId","data-v-b79b006d"]]),Gt={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between"},Kt={class:"flex flex-col md:flex-row gap-2 justify-start"},Xt={key:0,class:"va-h5 mb-4"},Yt={key:1,class:"va-h5 mb-4"},tn=W({__name:"ProjectsPage",setup(e){const t=it("projects-view",!0),{projects:n,update:a,add:r,isLoading:o,remove:i,pagination:p,sorting:f}=kt(),{users:g,getTeamOptions:l,getUserById:s}=we();Ne("ProjectsPage",{users:g,getTeamOptions:l,getUserById:s});const u=U(null),d=U(!1),b=V=>{u.value=V,d.value=!0},_=()=>{u.value=null,d.value=!0},{init:x}=ze(),m=async V=>{d.value=!1,"id"in V?(await a(V),x({message:"Project updated",color:"success"})):(await r(V),x({message:"Project created",color:"success"}))},{confirm:c}=Ie(),h=async V=>{await c({title:"Delete project",message:`Are you sure you want to delete project "${V.project_name}"?`,okText:"Delete",size:"small",maxWidth:"380px"})&&(await i(V),x({message:"Project deleted",color:"success"}))},D=U(),B=async V=>{D.value.isFormHasUnsavedChanges?await c({maxWidth:"380px",message:"Form has unsaved changes. Are you sure you want to close it?",size:"small"})&&V():V()};return(V,P)=>{const L=Be,Y=X,v=pe,$=Ee,F=de;return j(),O(ee,null,[P[6]||(P[6]=k("h1",{class:"page-title"},"Projects",-1)),w(F,null,{default:S(()=>[w(v,null,{default:S(()=>[k("div",Gt,[k("div",Kt,[w(L,{modelValue:y(t),"onUpdate:modelValue":P[0]||(P[0]=A=>G(t)?t.value=A:null),color:"background-element","border-color":"background-element",options:[{label:"Cards",value:!0},{label:"Table",value:!1}]},null,8,["modelValue"])]),w(Y,{icon:"add",onClick:_},{default:S(()=>[...P[5]||(P[5]=[z("Project",-1)])]),_:1})]),y(t)?(j(),E(Et,{key:0,projects:y(n),loading:y(o),onEdit:b,onDelete:h},null,8,["projects","loading"])):(j(),E(Wt,{key:1,"sort-by":y(f).sortBy,"onUpdate:sortBy":P[1]||(P[1]=A=>y(f).sortBy=A),"sorting-order":y(f).sortingOrder,"onUpdate:sortingOrder":P[2]||(P[2]=A=>y(f).sortingOrder=A),pagination:y(p),"onUpdate:pagination":P[3]||(P[3]=A=>G(p)?p.value=A:null),projects:y(n),loading:y(o),onEdit:b,onDelete:h},null,8,["sort-by","sorting-order","pagination","projects","loading"]))]),_:1}),w($,{modelValue:d.value,"onUpdate:modelValue":P[4]||(P[4]=A=>d.value=A),size:"small","mobile-fullscreen":"","close-button":"",stateful:"","hide-default-actions":"","before-cancel":B},{default:S(({cancel:A,ok:he})=>[u.value===null?(j(),O("h1",Xt,"Add project")):(j(),O("h1",Yt,"Edit project")),w(Ht,{ref_key:"editFormRef",ref:D,project:u.value,"save-button-label":u.value===null?"Add":"Save",onClose:A,onSave:je=>{m(je),he()}},null,8,["project","save-button-label","onClose","onSave"])]),_:1},8,["modelValue"])]),_:1})],64)}}});export{tn as default};
//# sourceMappingURL=ProjectsPage-C-TX1wp9.js.map
