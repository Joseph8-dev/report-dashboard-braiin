import{d as q,e as K,L as Q,i as X,u as E,a as Y,n as R,r as S,a5 as Z,w as T,g as B,a6 as ee,a7 as te,c as I,a8 as ne,H}from"./index-CNfBfxdc.js";const Ge=e=>e,qe=q({__name:"UserAvatar",props:{user:{type:Object,required:!0},size:{type:String,default:"medium"}},setup(e){const t=a=>{const s=["primary","#FFD43A","#ADFF00","#262824","danger"],o=a.charCodeAt(0)%s.length;return s[o]},n=a=>a?a.startsWith("http")||a.startsWith("blob:"):!1,r=a=>{try{const[s,o]=a.split(" ");return`${s[0]}${o[0]}`}catch{return a[0]}};return(a,s)=>{const o=Q;return X(),K(o,{size:e.size,src:n(e.user.avatar)?e.user.avatar:"","fallback-text":r(e.user.fullname),color:t(e.user.fullname)},null,8,["size","src","fallback-text","color"])}}});function re(e){return ee()?(te(e),!0):!1}function J(e){return typeof e=="function"?e():E(e)}const ae=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const se=e=>typeof e<"u",oe=Object.prototype.toString,ie=e=>oe.call(e)==="[object Object]",ue=()=>{};function ce(e,t){function n(...r){return new Promise((a,s)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(a).catch(s)})}return n}const M=e=>e();function le(e=M){const t=S(!0);function n(){t.value=!1}function r(){t.value=!0}const a=(...s)=>{t.value&&e(...s)};return{isActive:Z(t),pause:n,resume:r,eventFilter:a}}function de(e){return B()}function fe(e,t,n={}){const{eventFilter:r=M,...a}=n;return T(e,ce(r,t),a)}function pe(e,t,n={}){const{eventFilter:r,...a}=n,{eventFilter:s,pause:o,resume:f,isActive:p}=le(r);return{stop:fe(e,t,{...a,eventFilter:s}),pause:o,resume:f,isActive:p}}function ge(e,t=!0,n){de()?Y(e,n):t?e():R(e)}function me(e){var t;const n=J(e);return(t=n==null?void 0:n.$el)!=null?t:n}const _=ae?window:void 0;function L(...e){let t,n,r,a;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,r,a]=e,t=_):[t,n,r,a]=e,!t)return ue;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const s=[],o=()=>{s.forEach(i=>i()),s.length=0},f=(i,u,g,l)=>(i.addEventListener(u,g,l),()=>i.removeEventListener(u,g,l)),p=T(()=>[me(t),J(a)],([i,u])=>{if(o(),!i)return;const g=ie(u)?{...u}:u;s.push(...n.flatMap(l=>r.map(v=>f(i,l,v,g))))},{immediate:!0,flush:"post"}),d=()=>{p(),o()};return re(d),d}function ye(e){return JSON.parse(JSON.stringify(e))}const N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$="__vueuse_ssr_handlers__",ve=he();function he(){return $ in N||(N[$]=N[$]||{}),N[$]}function we(e,t){return ve[e]||t}function Se(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const be={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},z="vueuse-storage";function je(e,t,n,r={}){var a;const{flush:s="pre",deep:o=!0,listenToStorageChanges:f=!0,writeDefaults:p=!0,mergeDefaults:d=!1,shallow:i,window:u=_,eventFilter:g,onError:l=c=>{console.error(c)},initOnMounted:v}=r,w=(i?ne:S)(t);if(!n)try{n=we("getDefaultStorage",()=>{var c;return(c=_)==null?void 0:c.localStorage})()}catch(c){l(c)}if(!n)return w;const b=J(t),F=Se(b),A=(a=r.serializer)!=null?a:be[F],{pause:h,resume:x}=pe(w,()=>D(w.value),{flush:s,deep:o,eventFilter:g});u&&f&&ge(()=>{L(u,"storage",C),L(u,z,G),v&&C()}),v||C();function P(c,y){u&&u.dispatchEvent(new CustomEvent(z,{detail:{key:e,oldValue:c,newValue:y,storageArea:n}}))}function D(c){try{const y=n.getItem(e);if(c==null)P(y,null),n.removeItem(e);else{const O=A.write(c);y!==O&&(n.setItem(e,O),P(y,O))}}catch(y){l(y)}}function k(c){const y=c?c.newValue:n.getItem(e);if(y==null)return p&&b!=null&&n.setItem(e,A.write(b)),b;if(!c&&d){const O=A.read(y);return typeof d=="function"?d(O,b):F==="object"&&!Array.isArray(O)?{...b,...O}:O}else return typeof y!="string"?y:A.read(y)}function C(c){if(!(c&&c.storageArea!==n)){if(c&&c.key==null){w.value=b;return}if(!(c&&c.key!==e)){h();try{(c==null?void 0:c.newValue)!==A.write(w.value)&&(w.value=k(c))}catch(y){l(y)}finally{c?R(x):x()}}}}function G(c){C(c.detail)}return w}function Ke(e,t,n={}){const{window:r=_}=n;return je(e,t,r==null?void 0:r.localStorage,n)}function Qe(e,t,n,r={}){var a,s,o;const{clone:f=!1,passive:p=!1,eventName:d,deep:i=!1,defaultValue:u,shouldEmit:g}=r,l=B(),v=n||(l==null?void 0:l.emit)||((a=l==null?void 0:l.$emit)==null?void 0:a.bind(l))||((o=(s=l==null?void 0:l.proxy)==null?void 0:s.$emit)==null?void 0:o.bind(l==null?void 0:l.proxy));let w=d;t||(t="modelValue"),w=w||`update:${t.toString()}`;const b=h=>f?typeof f=="function"?f(h):ye(h):h,F=()=>se(e[t])?b(e[t]):u,A=h=>{g?g(h)&&v(w,h):v(w,h)};if(p){const h=F(),x=S(h);let P=!1;return T(()=>e[t],D=>{P||(P=!0,x.value=b(D),R(()=>P=!1))}),T(x,D=>{!P&&(D!==e[t]||i)&&A(D)},{deep:i}),x}else return I({get(){return F()},set(h){A(h)}})}const U=void 0,j={allUsers:()=>`${U}/users`,user:e=>`${U}/users/${e}`,users:({page:e,pageSize:t})=>`${U}/users/?page=${e}&pageSize=${t}`,allProjects:()=>`${U}/projects`,project:e=>`${U}/projects/${e}`,projects:({page:e,pageSize:t})=>`${U}/projects/?page=${e}&pageSize=${t}`,avatars:()=>`${U}/avatars`},Ae=async e=>{const t=await fetch(j.allProjects()).then(n=>n.json());return{data:t,pagination:{page:e.page,perPage:e.perPage,total:t.length}}},Oe=async e=>{const t=new Headers;return t.append("Content-Type","application/json"),fetch(j.allProjects(),{method:"POST",body:JSON.stringify(e),headers:t}).then(n=>n.json())},Pe=async e=>{const t=new Headers;return t.append("Content-Type","application/json"),fetch(j.project(e.id),{method:"PUT",body:JSON.stringify(e),headers:t}).then(n=>n.json())},Ue=async e=>fetch(j.project(e.id),{method:"DELETE"}),xe=H("projects",{state:()=>({items:[],pagination:{page:1,perPage:10,total:0}}),actions:{async getAll(e){const{data:t,pagination:n}=await Ae({...e.sorting,...e.pagination});this.items=t,this.pagination=n},async add(e){const[t]=await Oe(e);this.items.push(t)},async update(e){const[t]=await Pe(e),n=this.items.findIndex(({id:r})=>r===e.id);this.items.splice(n,1,t)},async remove(e){if(await Ue(e)){const n=this.items.findIndex(({id:r})=>r===e.id);this.items.splice(n,1)}}}}),m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));function De(e,t=0){return(m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+"-"+m[e[t+4]]+m[e[t+5]]+"-"+m[e[t+6]]+m[e[t+7]]+"-"+m[e[t+8]]+m[e[t+9]]+"-"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]).toLowerCase()}let V;const Ee=new Uint8Array(16);function Fe(){if(!V){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");V=crypto.getRandomValues.bind(crypto)}return V(Ee)}const Te=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),W={randomUUID:Te};function Ce(e,t,n){var a;if(W.randomUUID&&!e)return W.randomUUID();e=e||{};const r=e.random??((a=e.rng)==null?void 0:a.call(e))??Fe();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,De(r)}const Ne=async e=>{const{isActive:t,search:n}=e;let r=await fetch(j.allUsers()).then(o=>o.json());r=r.filter(o=>o.active===t),n&&(r=r.filter(o=>o.fullname.toLowerCase().includes(n.toLowerCase())));const{page:a=1,perPage:s=10}=e||{};return{data:r,pagination:{page:a,perPage:s,total:r.length}}},$e=async e=>{const t=new Headers;t.append("Content-Type","application/json");const n=await fetch(j.allUsers(),{method:"POST",body:JSON.stringify(e),headers:t}).then(r=>r.json());if(!n.error)return n;throw new Error(n.error)},_e=async e=>{const t=new Headers;t.append("Content-Type","application/json");const n=await fetch(j.user(e.id),{method:"PUT",body:JSON.stringify(e),headers:t}).then(r=>r.json());if(!n.error)return n;throw new Error(n.error)},Ve=async e=>fetch(j.user(e.id),{method:"DELETE"}),Re=async e=>fetch(j.avatars(),{method:"POST",body:e,redirect:"follow"}).then(t=>t.json()),Ie=H("users",{state:()=>({items:[],pagination:{page:1,perPage:10,total:0}}),actions:{async getAll(e){const{data:t,pagination:n}=await Ne({...e.filters,...e.sorting,...e.pagination});this.items=t,this.pagination=n},async add(e){const[t]=await $e(e);return this.items.unshift(t),t},async update(e){const[t]=await _e(e),n=this.items.findIndex(({id:r})=>r===e.id);return this.items.splice(n,1,t),t},async remove(e){if(await Ve(e)){const n=this.items.findIndex(({id:r})=>r===e.id);this.items.splice(n,1)}},async uploadAvatar(e){return Re(e)}}}),Je=()=>S({page:1,perPage:10,total:0}),Le=()=>S({sortBy:"fullname",sortingOrder:null}),ze=()=>S({isActive:!0,search:""}),We=e=>{const t=S(!1),n=S(),r=Ie(),{filters:a=ze(),sorting:s=Le(),pagination:o=Je()}={},f=async()=>{t.value=!0;try{await r.getAll({filters:E(a),sorting:E(s),pagination:E(o)}),o.value=r.pagination}finally{t.value=!1}};T(a,()=>{o.value.page=1,f()},{deep:!0}),f();const p=I(()=>{const d=(u,g)=>g==="projects"?u.projects.map(l=>l).join(", "):u[g],i=r.items.slice((o.value.page-1)*o.value.perPage,o.value.page*o.value.perPage);return s.value.sortBy&&s.value.sortingOrder&&i.sort((u,g)=>{const l=d(u,s.value.sortBy),v=d(g,s.value.sortBy);return l>v?s.value.sortingOrder==="asc"?1:-1:l<v?s.value.sortingOrder==="asc"?-1:1:0}),i});return{error:n,isLoading:t,filters:a,sorting:s,pagination:o,users:p,fetch:f,async add(d){t.value=!0;try{return await r.add(d)}catch(i){n.value=i}finally{t.value=!1}},async update(d){t.value=!0;try{return await r.update(d)}catch(i){n.value=i}finally{t.value=!1}},async remove(d){t.value=!0;try{return await r.remove(d)}catch(i){n.value=i}finally{t.value=!1}},async uploadAvatar(d){const i=new FormData;return i.append("avatar",d),i.append("id",Ce()),r.uploadAvatar(i)}}};function Be(){const{users:e}=We(),t=a=>e.value.find(({id:s})=>a===s),n=a=>{const s=["primary","#FFD43A","#ADFF00","#262824","danger"],o=a.charCodeAt(0)%s.length;return s[o]};return{users:e,getUserById:t,getTeamOptions:a=>a.reduce((s,o)=>{const f=t(o);return f&&s.push({label:f.fullname,src:f.avatar,fallbackText:f.fullname[0],color:n(f.fullname)}),s},[])}}const He=()=>S({page:1,perPage:10,total:0}),Me=()=>S({sortBy:"created_at",sortingOrder:"desc"}),Xe=e=>{const t=S(!1),n=xe(),{getUserById:r}=Be(),{sorting:a=Me(),pagination:s=He()}=e??{},o=async()=>{t.value=!0,await n.getAll({sorting:E(a),pagination:E(s)}),s.value=n.pagination,t.value=!1},f=I(()=>{const p=n.items.slice((s.value.page-1)*s.value.perPage,s.value.page*s.value.perPage),d=(i,u)=>{var g;return u==="project_owner"?(g=r(i.project_owner))==null?void 0:g.fullname:u==="team"?i.team.map(l=>{var v;return((v=r(l))==null?void 0:v.fullname)||""}).join(", "):u==="created_at"?new Date(i[u]):i[u]};return a.value.sortBy&&a.value.sortingOrder&&p.sort((i,u)=>(i=d(i,a.value.sortBy),u=d(u,a.value.sortBy),i<u?a.value.sortingOrder==="asc"?-1:1:i>u?a.value.sortingOrder==="asc"?1:-1:0)),p});return o(),{isLoading:t,projects:f,fetch:o,async add(p){t.value=!0,await n.add(p),await o(),t.value=!1},async update(p){t.value=!0,await n.update(p),await o(),t.value=!1},async remove(p){t.value=!0,await n.remove(p),await o(),t.value=!1},pagination:s,sorting:a}};export{qe as _,Xe as a,We as b,Ie as c,Ge as d,Ke as e,Be as f,Qe as u};
//# sourceMappingURL=useProjects-4U8MGeU3.js.map
